$stdin=open('day10.txt')

            o=0;     t=[  ];$<.  map{|  l|;     x=[*
     0..   999      ];;   for      xyz   in(      x);   ;a\
   =l.     sub    %r@     \[A      ?\]     |\(    \)|     \{a
  ?\}      |<>    |\n     @x,      %@@     ;if    a==     l;\
 x[0      ..-    1]=      [];      end      ;l=    +a;      end
l=~     /[\])    }>]      /x?      o+=      {?)    =>3,+     ?]\
 =>3      *19    ,?}      =>+      19*      63,    -?>      =>+
  441      *57    }[-     $&]      :t.     <<(    (
  ###      ###    ###     ###      ###     ###    ###      ###
  (q=->s,i {l[~i] ? q[s*5+(' ([{<'=~/#{?\\+l[~i]}/),i+1]: s})[0,0])
   ###     ###    ###     ###      ###     ###    ###     ###    
    ###    ###     ###    ###      ###    ###     ###    ###     
     ###   ###      ###   ###      ###   ###      ###   ###      
            ####     ###  #####  #####  ###     ####              
            ####     ###  BEGIN  {e=->  #####  ###     ####              
)}; p [o, t.sort[t.size/2]]
# __END__
#   {

# o=0;t=[]
# $<.map{|l|
#   0while l.gsub! /\[\]|\(\)|\{\}|<>|\n/,''
#   l=~/[\])}>]/?
#     o+={?)=>3,?]=>57,?}=>1197,?>=>25137}[$&]:
#     t<<(s=0;l.reverse.chars{|c|s=s*5+1+(c=~/[(\[{<]/)};s)
# }

# puts o
# puts t.sort[t.size/2]

__END__
[({(<(())[]>[[{[]{<()<>>
[(()[<>])]({[<{<<[]>>(
{([(<{}[<>[]}>{[]{[(<()>
(((({<>}<{<{<>}{[]{[]{}
[[<[([]))<([[{}[[()]]]
[{[{({}]{}}([{[{{{}}([]
{<[[]]>}<{[{[{[]{()[[[]
[<(<(<(<{}))><([]([]()
<{([([[(<>()){}]>(<<{{
<{([{{}}[<[[[<>{}]]]>[]]

__END__

            ####     ###  #####  #####  ###     ####              
     ###   ###      ###   ###      ###   ###      ###   ###      
    ###    ###     ###    ###      ###    ###     ###    ###     
   ###     ###    ###     ###      ###     ###    ###     ###    
  ###      ###    ###     ###      ###     ###    ###      ###   
 ###      ###    ###      ###      ###      ###    ###      ###  
###     #####    ###      ###      ###      ###    #####     ### 
 ###      ###    ###      ###      ###      ###    ###      ###  
  ###      ###    ###     ###      ###     ###    ###      ###   
   ###     ###    ###     ###      ###     ###    ###     ###    
    ###    ###     ###    ###      ###    ###     ###    ###     
     ###   ###      ###   ###      ###   ###      ###   ###      
            ####     ###  #####  #####  ###     ####              
  {
$stdin=open('day10.txt')

o=0;t=[]
$<.map{|l|
  0while l.gsub! /\[\]|\(\)|\{\}|<>|\n/,''
  l=~/[\])}>]/?
    o+={?)=>3,?]=>57,?}=>1197,?>=>25137}[$&]:
    t<<(s=0;l.reverse.chars{|c|s=s*5+1+(c=~/[(\[{<]/)};s)
}

puts o
puts t.sort[t.size/2]
